# 🚀 AI株式取引システム 運用コマンド一覧

**作成日**: 2025年9月15日  
**システム精度**: 78.5%（目標達成済み）  
**最適運用**: 12%利確、2%損切り、8日保持で198,725%リターン実績

---

## 🚀 **日次運用メインコマンド**

### 🎯 **ワンコマンド自動実行**
```bash
python daily_trading_automation.py
```

#### **💡 実行タイミングと分析対象日の自動選択**
- **推奨実行時刻**: 毎日15:00以降（市場終了後）
- **15:00以降に実行**: 当日のデータを分析 → 翌営業日の推奨銘柄を生成
- **15:00前に実行**: 前営業日のデータを分析 → 当日の推奨銘柄を生成
- **週末・祝日に実行**: 直近営業日のデータを使用

#### **🔄 自動実行される処理（順番）**

##### **STEP 1: 日経225全銘柄データ取得** (約5-10分)
- **処理内容**: J-Quants APIから日経225全225銘柄の最新株価データを取得
- **取得データ**: 始値・高値・安値・終値・出来高・調整済み価格
- **データ期間**: 10年分の過去データ + 最新データ
- **保存場所**: `data/real_jquants_data/nikkei225_real_data_*.pkl`
- **🔄 自動化**: 実行時刻に応じたタイムスタンプ付きファイル名で自動保存
- **実行確認**: ログに「✅ 日経225全銘柄データ取得 完了」と表示

##### **STEP 2: 外部市場データ統合** (約2-3分)
- **処理内容**: Yahoo Finance APIから外部市場データを取得・統合
- **取得データ**: USD/JPY為替、VIX恐怖指数、S&P500、TOPIX、NASDAQ
- **目的**: 外部環境を考慮した高精度予測の実現
- **保存場所**: `data/processed/enhanced_integrated_data.parquet`
- **🔄 自動化**: 実行日までの最新データを動的に取得・統合
- **実行確認**: ログに「✅ 外部市場データ統合 完了」と表示

##### **STEP 3: Enhanced V3 AI予測実行** (約10-15分)
- **処理内容**: 78.5%精度のメインAIシステムで株価上昇を予測
- **手法**: LightGBM + 外部データ統合 + Walk-forward最適化
- **予測対象**: 日経225全銘柄の翌日株価上昇確率
- **出力**: 予測結果、精度レポート、高確信度銘柄リスト
- **🔄 自動化**: 最新のデータファイルを自動検索・使用（更新日時基準）
- **実行確認**: ログに「✅ Enhanced V3 AI予測システム実行 完了」と表示

##### **STEP 4: 日次推奨銘柄レポート生成** (約2-3分)
- **処理内容**: AIが60%以上の確信度で上昇予測した銘柄のレポート作成
- **出力内容**: 銘柄コード、会社名、予測確信度、推奨理由、投資額
- **レポート形式**: 日付別ファイル（YYYY-MM-DD形式）
- **保存場所**: `production_reports/daily_recommendation_YYYY-MM-DD.md`
- **🔄 自動化**: 実行日を自動検出、対応する日付でレポート生成
- **実行確認**: ログに「✅ 日次推奨銘柄レポート生成 完了」と表示

#### **📊 実行結果の確認方法**

##### **コンソール出力例**
```
🚀 日次AI株式取引システム 自動実行開始
⏰ 実行開始時刻: 2025-09-16 23:28:00
📊 分析対象日: 2025-09-16
🎯 推奨取引日: 2025-09-17
📊 STEP 1/4: 日経225全銘柄データ取得
✅ 日経225全銘柄データ取得 完了 (実行時間: 456.2秒)
📊 STEP 2/4: 外部市場データ統合
✅ 外部市場データ統合 完了 (実行時間: 123.4秒)
📊 STEP 3/4: Enhanced V3 AI予測システム実行
✅ Enhanced V3 AI予測システム実行 完了 (実行時間: 867.3秒)
📊 STEP 4/4: 日次推奨銘柄レポート生成
✅ 日次推奨銘柄レポート生成 完了 (実行時間: 89.1秒)

🎉 全ステップが正常に完了しました！
📈 2025-09-17の推奨銘柄レポートを確認してください
📂 レポート: production_reports/2025-09/2025-09-16.md
```

##### **生成されるファイル**
- `daily_automation.log`: 詳細実行ログ
- `production_reports/YYYY-MM/YYYY-MM-DD.md`: 推奨銘柄レポート（分析対象日の日付）

#### **⚠️ エラー時の対応**
- 失敗したSTEPがある場合、個別コマンドで再実行
- ログファイル `daily_automation.log` でエラー詳細を確認

#### **⏱️ 実行時間目安**
- **正常時**: 約20-35分
- **データ量多い時**: 約40-50分

---

### 💰 **利益最適化システム**（月1回実行）

### 利確・損切り最適化
```bash
python systems/enhanced_v3_profit_loss_optimizer.py
```
**詳細**:
- **目的**: 最適な利確・損切りパラメータの検証
- **実績**: 最大198,725%リターン達成
- **最適解**: 12%利確、2%損切り、8日保持
- **テスト**: 22,040通りのパラメータ組み合わせ（38×29×20）
- **実行時間**: 約60-120分（重い処理）
- **頻度**: 月1回程度
- **🔄 自動化**: 最新データファイルを自動検索、現在日付までの期間で検証

### 実世界検証
```bash
python optimization/real_world_validation.py
```
**詳細**:
- **目的**: 実際の市場データでの性能検証
- **内容**: バックテスト、リスク分析、Sharpe比率計算
- **用途**: システム信頼性の確認
- **実行時間**: 約20-30分
- **頻度**: 週1回程度

---

## 📊 **データ管理・メンテナンス**

### 基本データ取得（軽量版）
```bash
python data_management/nikkei225_parallel_fetcher.py
```
**詳細**:
- **用途**: 軽量なデータ取得（complete版より軽い）
- **対象**: 主要銘柄のみ
- **実行時間**: 約3-5分
- **使用場面**: テスト時やリソース制約時

### Yahoo Finance拡張取得
```bash
python data_management/yahoo_finance_extended_fetcher.py
```
**詳細**:
- **用途**: Yahoo Financeからの補完データ取得
- **対象**: J-Quantsで取得できない銘柄や指標
- **実行時間**: 約5-10分

---

## 📅 **日付指定実行オプション**

### 特定日のレポート作成
```bash
# 特定日のデータで推奨銘柄レポートを作成
python reports/daily_stock_recommendation_v3.py --date 2025-09-12
```
**詳細**:
- **--date**: 分析対象日を指定（YYYY-MM-DD形式）
- **用途**: 過去の特定日のデータで分析したい場合
- **出力**: 指定日の翌営業日向け推奨銘柄

### TOP N銘柄の指定
```bash
# 特定日のTOP10銘柄を表示
python reports/daily_stock_recommendation_v3.py --date 2025-09-12 --top 10
```
**詳細**:
- **--top**: 表示する推奨銘柄数を指定（デフォルト: 5）
- **用途**: より多くの候補銘柄を確認したい場合

### 使用例
```bash
# 金曜日（9/12）のデータで月曜日（9/16）向けの推奨を作成
python reports/daily_stock_recommendation_v3.py --date 2025-09-12

# 最新データで推奨（日付指定なし = 前日データ使用）
python reports/daily_stock_recommendation_v3.py

# TOP20銘柄を確認
python reports/daily_stock_recommendation_v3.py --date 2025-09-12 --top 20
```

**注意事項**:
- daily_trading_automation.py は日付指定オプションなし（常に前日データ使用）
- 個別レポート作成のみ日付指定可能

---

## 🔍 **分析・レポートシステム**

### バックテスト分析
```bash
python production/production_backtest_analyzer.py
```
**詳細**:
- **内容**: 過去データでの詳細性能分析
- **出力**: 勝率、平均利益、最大ドローダウン等
- **用途**: システム性能の定量評価
- **実行時間**: 約15-20分

### データ品質監視
```bash
python data_management/data_source_monitor.py
```
**詳細**:
- **目的**: データ取得状況の監視
- **確認項目**: 欠損データ、異常値、取得エラー
- **頻度**: 週1回程度

---

## ⚡ **実行スケジュール**

### 📅 **毎日（平日）15:00以降推奨**
```bash
python daily_trading_automation.py
```
**理由**: 15:00以降なら当日の完全なデータで翌営業日の推奨銘柄を生成できる

### 📅 **月1回（第1土曜日）**
```bash
python systems/enhanced_v3_profit_loss_optimizer.py
```

---

## 🎯 **運用のポイント**

### ✅ **日次運用**
1. **毎朝1回実行**: `python daily_trading_automation.py`
2. **確信度60%以上の銘柄のみ投資**
3. **12%利確、2%損切り、8日保持が最適戦略**
4. **市場休場日は実行不要**

### 📊 **期待成果**
- **予測精度**: 78.5%
- **最適運用リターン**: 198,725%（シミュレーション実績）
- **年間期待リターン**: 565%

### 📂 **確認場所**
- **推奨銘柄**: `production_reports/YYYY-MM/YYYY-MM-DD.md`（分析対象日のファイル名）
- **実行ログ**: `daily_automation.log`
- **例**: 9/16 23:28実行 → `production_reports/2025-09/2025-09-16.md`に9/17向け推奨を生成

---

**システム整理完了日**: 2025年9月15日  
**総ファイル数**: 250+（6フォルダに整理済み）  
**運用可能状態**: ✅ 完全準備完了